<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ular Tangga Truth or Dare</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&family=Righteous&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #6C63FF;
            --primary-dark: #564FD8;
            --secondary: #FF6584;
            --dark: #2D3748;
            --light: #F7FAFC;
            --success: #48BB78;
            --danger: #F56565;
            --warning: #F6AD55;
            --gray: #A0AEC0;
            --dark-gray: #4A5568;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            color: var(--dark);
            overflow-x: hidden;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        /* === SCREEN STYLES === */
        .screen {
            display: none;
            width: 100%;
            animation: fadeIn 0.5s;
        }

        .screen.active {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 80vh;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* === HEADER STYLES === */
        .game-header {
            text-align: center;
            margin-bottom: 2rem;
        }

        .game-title {
            font-family: 'Righteous', cursive;
            font-size: 3rem;
            color: var(--primary);
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 0.5rem;
            background: linear-gradient(to right, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .game-subtitle {
            font-size: 1rem;
            color: var(--dark-gray);
            font-weight: 400;
        }

        /* === BUTTON STYLES === */
        .btn {
            background-color: var(--primary);
            color: white;
            border: none;
            padding: 12px 24px;
            margin: 10px;
            border-radius: 50px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .btn:hover {
            background-color: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.15);
        }

        .btn:active {
            transform: translateY(0);
        }

        .btn-secondary {
            background-color: var(--secondary);
        }

        .btn-secondary:hover {
            background-color: #e64c6d;
        }

        .btn-outline {
            background-color: transparent;
            border: 2px solid var(--primary);
            color: var(--primary);
        }

        .btn-outline:hover {
            background-color: var(--primary);
            color: white;
        }

        .btn-small {
            padding: 8px 16px;
            font-size: 0.8rem;
        }

        /* === CARD STYLES === */
        .card {
            background-color: white;
            border-radius: 16px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            padding: 2rem;
            margin: 1rem 0;
            width: 100%;
            max-width: 800px;
            transition: transform 0.3s ease;
        }

        .card:hover {
            transform: translateY(-5px);
        }

        /* === PLAYER INPUT === */
        .player-input-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 2rem 0;
            width: 100%;
        }

        .player-input {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .color-preview {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            margin-bottom: 1rem;
            display: flex;
            justify-content: center;
            align-items: center;
            color: white;
            font-weight: bold;
            font-size: 1.2rem;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
        }

        .color-preview:hover {
            transform: scale(1.1);
        }

        .player-input input {
            padding: 12px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            width: 100%;
            text-align: center;
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .player-input input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(108, 99, 255, 0.2);
        }

        /* === GAME BOARD === */
        .board-container {
            position: relative;
            width: 100%;
            max-width: 700px;
            margin: 2rem auto;
            perspective: 1000px;
        }

        .board {
            display: grid;
            grid-template-columns: repeat(10, 1fr);
            gap: 4px;
            width: 100%;
            background-color: white;
            padding: 15px;
            border-radius: 16px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.1);
            transform-style: preserve-3d;
            transform: rotateX(5deg);
            position: relative;
            z-index: 1;
        }

        .board::before {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 5%;
            width: 90%;
            height: 20px;
            background: rgba(0,0,0,0.1);
            border-radius: 50%;
            filter: blur(10px);
            z-index: -1;
        }

        .cell {
            aspect-ratio: 1;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 12px;
            font-weight: bold;
            position: relative;
            border-radius: 8px;
            background-color: #f8fafc;
            transition: all 0.3s ease;
            box-shadow: inset 0 0 0 1px rgba(0,0,0,0.05);
        }

        .cell:hover {
            transform: scale(1.05);
            z-index: 5;
        }

        .cell.snake {
            background: linear-gradient(135deg, var(--danger), #fc8181);
            color: white;
        }

        .cell.ladder {
            background: linear-gradient(135deg, var(--success), #68d391);
            color: white;
        }

        .cell.warning {
            background: linear-gradient(135deg, var(--warning), #f6ad55);
            color: white;
        }

        .cell-number {
            position: absolute;
            top: 2px;
            left: 2px;
            font-size: 0.7rem;
            color: var(--dark-gray);
        }

        .piece {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            position: absolute;
            border: 2px solid white;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            transition: all 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            z-index: 10;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 0.7rem;
            font-weight: bold;
            color: white;
        }

        /* === SCOREBOARD === */
        .scoreboard {
            background-color: white;
            border-radius: 16px;
            padding: 1.5rem;
            margin: 1rem auto;
            width: 100%;
            max-width: 400px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            position: relative;
            overflow: hidden;
        }

        .scoreboard::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 8px;
            height: 100%;
            background: linear-gradient(to bottom, var(--primary), var(--secondary));
        }

        .scoreboard h3 {
            margin-bottom: 1rem;
            color: var(--dark);
            font-size: 1.2rem;
            display: flex;
            align-items: center;
        }

        .scoreboard h3::before {
            content: 'üèÜ';
            margin-right: 10px;
        }

        .score-item {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid #edf2f7;
            align-items: center;
        }

        .score-item:last-child {
            border-bottom: none;
        }

        .player-rank {
            display: flex;
            align-items: center;
            font-weight: 600;
        }

        .player-color {
            width: 16px;
            height: 16px;
            border-radius: 50%;
            margin-right: 10px;
            flex-shrink: 0;
        }

        .player-position {
            background-color: var(--primary);
            color: white;
            padding: 2px 8px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: bold;
        }

        /* === CONTROLS === */
        .controls {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            margin: 2rem 0;
        }

        .dice-container {
            position: relative;
            width: 80px;
            height: 80px;
            perspective: 1000px;
        }

        .dice {
            width: 100%;
            height: 100%;
            background-color: white;
            border-radius: 16px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 2rem;
            font-weight: bold;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            transform-style: preserve-3d;
            transition: transform 0.5s ease;
            position: relative;
            cursor: pointer;
        }

        .dice::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            border-radius: 16px;
            box-shadow: inset 0 0 0 2px rgba(0,0,0,0.1);
            pointer-events: none;
        }

        .dice.rolling {
            animation: rollDice 0.5s ease-in-out infinite;
        }

        @keyframes rollDice {
            0%, 100% { transform: rotateX(0) rotateY(0); }
            25% { transform: rotateX(90deg) rotateY(0); }
            50% { transform: rotateX(180deg) rotateY(90deg); }
            75% { transform: rotateX(0) rotateY(180deg); }
        }

        /* === CURRENT TURN === */
        .current-turn {
            font-weight: 700;
            text-align: center;
            margin: 1rem 0;
            padding: 12px 20px;
            background-color: white;
            border-radius: 50px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            display: inline-flex;
            align-items: center;
        }

        .current-turn-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 10px;
            animation: pulse 1.5s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.2); opacity: 0.8; }
            100% { transform: scale(1); opacity: 1; }
        }

        /* === VOICE CONTROL === */
        .voice-control {
            text-align: center;
            margin: 1rem 0;
        }

        .mic-status {
            font-size: 0.9rem;
            color: var(--dark-gray);
            margin-top: 0.5rem;
        }

        .mic-btn {
            background-color: var(--primary);
            border-radius: 50%;
            width: 60px;
            height: 60px;
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 0 auto;
            cursor: pointer;
            box-shadow: 0 6px 12px rgba(108, 99, 255, 0.3);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .mic-btn::before {
            content: '';
            position: absolute;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle, rgba(255,255,255,0.4) 0%, rgba(255,255,255,0) 70%);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .mic-btn:hover::before {
            opacity: 1;
        }

        .mic-btn i {
            font-size: 1.5rem;
            color: white;
        }

        .mic-btn.active {
            background-color: var(--success);
            box-shadow: 0 6px 12px rgba(72, 187, 120, 0.3);
            animation: pulse 1.5s infinite;
        }

        .mic-btn.error {
            background-color: var(--danger);
            box-shadow: 0 6px 12px rgba(245, 101, 101, 0.3);
        }

        /* === MODAL === */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.7);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            backdrop-filter: blur(5px);
            animation: fadeIn 0.3s ease;
        }

        .modal-content {
            background-color: white;
            padding: 2rem;
            border-radius: 20px;
            width: 90%;
            max-width: 400px;
            text-align: center;
            position: relative;
            transform: scale(0.9);
            opacity: 0;
            animation: modalOpen 0.3s ease forwards;
            box-shadow: 0 20px 40px rgba(0,0,0,0.2);
        }

        @keyframes modalOpen {
            to {
                transform: scale(1);
                opacity: 1;
            }
        }

        .modal h2 {
            margin-bottom: 1.5rem;
            color: var(--primary);
            font-size: 1.8rem;
        }

        .modal-buttons {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 1.5rem;
        }

        .task-card {
            background: linear-gradient(135deg, #f6f9fc 0%, #eef2f5 100%);
            border-radius: 12px;
            padding: 1.5rem;
            margin: 1rem 0;
            border-left: 5px solid var(--primary);
            text-align: left;
        }

        .task-card h3 {
            color: var(--primary);
            margin-bottom: 0.5rem;
            font-size: 1.2rem;
        }

        .task-card p {
            color: var(--dark);
            font-size: 1rem;
            line-height: 1.5;
        }

        /* === WINNER ANIMATION === */
        .confetti {
            position: fixed;
            width: 12px;
            height: 12px;
            opacity: 0;
            z-index: 999;
            animation: confetti 3s ease-out;
        }

        @keyframes confetti {
            0% { transform: translateY(0) rotate(0deg) scale(1); opacity: 1; }
            100% { transform: translateY(100vh) rotate(720deg) scale(0.5); opacity: 0; }
        }

        .winner-glow {
            position: absolute;
            width: 200px;
            height: 200px;
            background: radial-gradient(circle, rgba(108, 99, 255, 0.4) 0%, rgba(108, 99, 255, 0) 70%);
            border-radius: 50%;
            animation: glowPulse 2s infinite alternate;
            z-index: -1;
        }

        @keyframes glowPulse {
            from { transform: scale(0.8); opacity: 0.6; }
            to { transform: scale(1.2); opacity: 0.9; }
        }

        /* === ONLINE GAME STYLES === */
        .mode-select {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 2rem 0;
            flex-wrap: wrap;
        }

        .mode-card {
            background-color: white;
            border-radius: 16px;
            padding: 2rem;
            width: 280px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .mode-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.15);
        }

        .mode-card i {
            font-size: 3rem;
            margin-bottom: 1rem;
            color: var(--primary);
        }

        .mode-card h3 {
            margin-bottom: 0.5rem;
            color: var(--dark);
        }

        .mode-card p {
            color: var(--dark-gray);
            font-size: 0.9rem;
        }

        .room-code {
            font-size: 2rem;
            font-weight: bold;
            letter-spacing: 5px;
            color: var(--primary);
            margin: 1rem 0;
            padding: 10px 20px;
            background-color: #f8f9fa;
            border-radius: 8px;
            display: inline-block;
        }

        .room-options {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin: 1.5rem 0;
        }

        .room-option {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
        }

        .room-option label {
            margin-bottom: 5px;
            font-weight: 600;
            color: var(--dark-gray);
        }

        .room-option input, .room-option select {
            width: 100%;
            padding: 10px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 1rem;
        }

        .room-option input:focus, .room-option select:focus {
            outline: none;
            border-color: var(--primary);
        }

        .lobby {
            width: 100%;
            max-width: 500px;
            margin: 1rem auto;
        }

        .player-list {
            background-color: white;
            border-radius: 12px;
            padding: 1.5rem;
            margin: 1rem 0;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .player-item {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid #edf2f7;
            align-items: center;
        }

        .player-item:last-child {
            border-bottom: none;
        }

        .player-info {
            display: flex;
            align-items: center;
        }

        .player-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: var(--primary);
            color: white;
            display: flex;
            justify-content: center;
            align-items: center;
            margin-right: 10px;
            font-weight: bold;
        }

        .player-status {
            font-size: 0.8rem;
            padding: 3px 8px;
            border-radius: 20px;
            background-color: #e2e8f0;
            color: var(--dark-gray);
        }

        .player-status.ready {
            background-color: var(--success);
            color: white;
        }

        .player-status.admin {
            background-color: var(--primary);
            color: white;
        }

        /* === CUSTOM TASKS STYLES === */
        .task-form-container {
            width: 100%;
            max-width: 600px;
            margin: 1rem auto;
        }

        .task-form {
            background-color: white;
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 1rem;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .task-form h3 {
            color: var(--primary);
            margin-bottom: 1rem;
            text-align: center;
        }

        .task-input-group {
            margin-bottom: 1rem;
        }

        .task-input-group label {
            display: block;
            margin-bottom: 0.5rem;
            color: var(--dark-gray);
            font-weight: 600;
        }

        .task-input-group select,
        .task-input-group textarea,
        .task-input-group input {
            width: 100%;
            padding: 10px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-family: 'Poppins', sans-serif;
        }

        .task-input-group textarea {
            min-height: 100px;
            resize: vertical;
        }

        .task-controls {
            display: flex;
            justify-content: space-between;
            margin-top: 1.5rem;
        }

        .task-counter {
            text-align: center;
            margin: 1rem 0;
            color: var(--dark-gray);
            font-size: 0.9rem;
        }

        /* === RESPONSIVE DESIGN === */
        @media (max-width: 768px) {
            .game-title {
                font-size: 2rem;
            }
            
            .player-input-container {
                grid-template-columns: 1fr 1fr;
            }
            
            .board {
                grid-template-columns: repeat(10, 1fr);
                gap: 2px;
                padding: 10px;
            }
            
            .cell {
                font-size: 10px;
            }
            
            .piece {
                width: 18px;
                height: 18px;
                font-size: 0.6rem;
            }
            
            .dice-container {
                width: 60px;
                height: 60px;
            }
            
            .dice {
                font-size: 1.5rem;
            }

            .mode-select {
                flex-direction: column;
                align-items: center;
            }

            .mode-card {
                width: 100%;
                max-width: 300px;
            }
        }

        @media (max-width: 480px) {
            .game-title {
                font-size: 1.8rem;
            }
            
            .player-input-container {
                grid-template-columns: 1fr;
            }
            
            .controls {
                flex-direction: column;
            }
            
            .modal-buttons {
                flex-direction: column;
            }
            
            .modal-content {
                padding: 1.5rem;
            }
        }

        /* === UTILITY CLASSES === */
        .text-center {
            text-align: center;
        }

        .mt-1 { margin-top: 0.5rem; }
        .mt-2 { margin-top: 1rem; }
        .mt-3 { margin-top: 1.5rem; }
        .mt-4 { margin-top: 2rem; }

        .mb-1 { margin-bottom: 0.5rem; }
        .mb-2 { margin-bottom: 1rem; }
        .mb-3 { margin-bottom: 1.5rem; }
        .mb-4 { margin-bottom: 2rem; }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body>
    <div class="container">
        <!-- SCREEN 1: START MENU -->
        <div class="screen active" id="start-screen">
            <div class="game-header">
                <h1 class="game-title">Ular Tangga</h1>
                <h2 class="game-subtitle">Truth or Dare</h2>
                <h2 class="game-subtitle">Powered By HIMABIDA</h2>
            </div>
            <div class="card">
                <img src="ular.jpeg" alt="Game Illustration" style="width: 100%; max-width: 300px; margin: 0 auto 1rem; display: block;">
                <button id="start-btn" class="btn btn-secondary">
                    <i class="fas fa-play mr-1"></i> Mulai Game
                </button>
            </div>
        </div>

        <!-- SCREEN 2: MODE SELECTION -->
        <div class="screen" id="mode-screen">
            <div class="card">
                <h1 class="text-center">Pilih Mode Permainan</h1>
                <p class="text-center">Main sendiri atau bersama teman secara online?</p>
                
                <div class="mode-select">
                    <div class="mode-card" id="offline-mode">
                        <i class="fas fa-user-friends"></i>
                        <h3>Offline</h3>
                        <p>Main sendiri dengan teman-teman di satu perangkat</p>
                    </div>
                    <div class="mode-card" id="online-mode">
                        <i class="fas fa-globe"></i>
                        <h3>Online</h3>
                        <p>Main bersama teman secara online dari jarak jauh</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- SCREEN 3: RULES (OFFLINE) -->
        <div class="screen" id="rules-screen">
            <div class="card">
                <h1 class="text-center">Aturan Main</h1>
                <div class="rules-list">
                    <div class="rule-item">
                        <div class="rule-icon"><i class="fas fa-users"></i></div>
                        <p>Pilih jumlah pemain (2-8 orang)</p>
                    </div>
                    <div class="rule-item">
                        <div class="rule-icon"><i class="fas fa-palette"></i></div>
                        <p>Setiap pemain akan dapat pion warna berbeda</p>
                    </div>
                    <div class="rule-item">
                        <div class="rule-icon"><i class="fas fa-microphone"></i></div>
                        <p><strong>Bilang "MULAI" untuk lempar dadu</strong> (atau klik tombol)</p>
                    </div>
                    <div class="rule-item">
                        <div class="rule-icon"><i class="fas fa-snake"></i></div>
                        <p>Jika mendarat di:</p>
                        <ul>
                            <li><span style="color: var(--success);">Tangga (Hijau)</span>: Naik ke posisi spesifik</li>
                            <li><span style="color: var(--danger);">Ular (Merah)</span>: Turun ke posisi spesifik</li>
                            <li><span style="color: var(--warning);">Truth/Dare (Kuning)</span>: Pilih tantangan!</li>
                        </ul>
                    </div>
                    <div class="rule-item">
                        <div class="rule-icon"><i class="fas fa-trophy"></i></div>
                        <p>Pemain pertama yang sampai di kotak 100 menang!</p>
                    </div>
                </div>
                <button id="next-btn" class="btn">
                    Selanjutnya <i class="fas fa-arrow-right ml-1"></i>
                </button>
            </div>
        </div>

        <!-- SCREEN 4: PLAYER COUNT (OFFLINE) -->
        <div class="screen" id="count-screen">
            <div class="card">
                <h1 class="text-center">Jumlah Pemain</h1>
                <p class="text-center">Pilih jumlah pemain:</p>
                <div class="player-count-buttons">
                    <button class="count-btn btn btn-outline" data-count="2">
                        <i class="fas fa-user-friends mr-1"></i> 2 Pemain
                    </button>
                    <button class="count-btn btn btn-outline" data-count="3">
                        <i class="fas fa-users mr-1"></i> 3 Pemain
                    </button>
                    <button class="count-btn btn btn-outline" data-count="4">
                        <i class="fas fa-users mr-1"></i> 4 Pemain
                    </button>
                    <button class="count-btn btn btn-outline" data-count="5">
                        <i class="fas fa-users mr-1"></i> 5 Pemain
                    </button>
                    <button class="count-btn btn btn-outline" data-count="6">
                        <i class="fas fa-users mr-1"></i> 6 Pemain
                    </button>
                    <button class="count-btn btn btn-outline" data-count="7">
                        <i class="fas fa-users mr-1"></i> 7 Pemain
                    </button>
                    <button class="count-btn btn btn-outline" data-count="8">
                        <i class="fas fa-users mr-1"></i> 8 Pemain
                    </button>
                </div>
            </div>
        </div>

        <!-- SCREEN 5: PLAYER NAMES (OFFLINE) -->
        <div class="screen" id="names-screen">
            <div class="card">
                <h1 class="text-center">Input Nama Pemain</h1>
                <div id="player-inputs" class="player-input-container"></div>
                <button id="start-game-btn" class="btn">
                    <i class="fas fa-gamepad mr-1"></i> Mulai Bermain
                </button>
            </div>
        </div>

        <!-- SCREEN 6: CUSTOM TASKS (OFFLINE/ONLINE) -->
        <div class="screen" id="custom-tasks-screen">
            <div class="card">
                <div class="task-form-container">
                    <h1 class="text-center">Custom Truth/Dare</h1>
                    <p class="text-center" id="current-player-text">Giliran <span id="current-player-name"></span> untuk membuat tantangan</p>
                    
                    <div class="task-form">
                        <h3>Tantangan Baru</h3>
                        <div class="task-input-group">
                            <label for="task-type">Jenis Tantangan</label>
                            <select id="task-type">
                                <option value="truth">Truth</option>
                                <option value="dare">Dare</option>
                            </select>
                        </div>
                        <div class="task-input-group">
                            <label for="task-text">Teks Tantangan</label>
                            <textarea id="task-text" placeholder="Masukkan teks truth/dare..."></textarea>
                        </div>
                        <div class="task-input-group">
                            <label for="task-cell">Nomor Kotak (1-100)</label>
                            <input type="number" id="task-cell" min="1" max="100" placeholder="Masukkan nomor kotak">
                        </div>
                        <div class="task-counter" id="task-counter">
                            Anda telah membuat 0 dari 3 tantangan
                        </div>
                        <div class="task-controls">
                            <button id="add-task-btn" class="btn btn-outline">
                                <i class="fas fa-plus mr-1"></i> Tambah Lagi
                            </button>
                            <button id="done-task-btn" class="btn">
                                <i class="fas fa-check mr-1"></i> Selesai
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- SCREEN 7: ONLINE MODE SELECTION -->
        <div class="screen" id="online-options-screen">
            <div class="card">
                <h1 class="text-center">Mode Online</h1>
                <p class="text-center">Buat room baru atau gabung room yang sudah ada</p>
                
                <div class="mode-select">
                    <div class="mode-card" id="create-room-btn">
                        <i class="fas fa-plus-circle"></i>
                        <h3>Buat Room</h3>
                        <p>Buat room baru dan undang teman untuk bergabung</p>
                    </div>
                    <div class="mode-card" id="join-room-btn">
                        <i class="fas fa-sign-in-alt"></i>
                        <h3>Gabung Room</h3>
                        <p>Gabung ke room yang sudah ada dengan kode room</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- SCREEN 8: CREATE ROOM -->
        <div class="screen" id="create-room-screen">
            <div class="card">
                <h1 class="text-center">Buat Room Baru</h1>
                
                <div class="room-options">
                    <div class="room-option">
                        <label for="player-name">Nama Anda</label>
                        <input type="text" id="host-name" placeholder="Masukkan nama Anda">
                    </div>
                    <div class="room-option">
                        <label for="max-players">Jumlah Pemain</label>
                        <select id="max-players">
                            <option value="2">2 Pemain</option>
                            <option value="3">3 Pemain</option>
                            <option value="4">4 Pemain</option>
                            <option value="5">5 Pemain</option>
                            <option value="6">6 Pemain</option>
                            <option value="7">7 Pemain</option>
                            <option value="8">8 Pemain</option>
                        </select>
                    </div>
                </div>
                
                <button id="create-room-confirm" class="btn">
                    <i class="fas fa-plus-circle mr-1"></i> Buat Room
                </button>
            </div>
        </div>

        <!-- SCREEN
            <!-- SCREEN 9: ROOM LOBBY (HOST) -->
        <div class="screen" id="host-lobby-screen">
            <div class="card">
                <h1 class="text-center">Room Anda</h1>
                <p class="text-center">Bagikan kode ini ke teman Anda:</p>
                <div class="room-code" id="room-code-display">ABCD12</div>
                
                <div class="lobby">
                    <h3><i class="fas fa-users mr-1"></i> Pemain di Room</h3>
                    <div class="player-list" id="host-player-list">
                        <!-- Player list will be populated here -->
                    </div>
                </div>
                
                <p class="text-center">Menunggu pemain lain bergabung...</p>
                <button id="host-start-btn" class="btn" disabled>
                    <i class="fas fa-play mr-1"></i> Mulai Game
                </button>
            </div>
        </div>

        <!-- SCREEN 10: JOIN ROOM -->
        <div class="screen" id="join-room-screen">
            <div class="card">
                <h1 class="text-center">Gabung Room</h1>
                
                <div class="room-options">
                    <div class="room-option">
                        <label for="join-player-name">Nama Anda</label>
                        <input type="text" id="join-player-name" placeholder="Masukkan nama Anda">
                    </div>
                    <div class="room-option">
                        <label for="room-code">Kode Room</label>
                        <input type="text" id="room-code" placeholder="Masukkan kode room">
                    </div>
                </div>
                
                <button id="join-room-confirm" class="btn">
                    <i class="fas fa-sign-in-alt mr-1"></i> Gabung Room
                </button>
            </div>
        </div>

        <!-- SCREEN 11: ROOM LOBBY (GUEST) -->
        <div class="screen" id="guest-lobby-screen">
            <div class="card">
                <h1 class="text-center">Room</h1>
                <p class="text-center">Kode Room: <span class="room-code" id="guest-room-code">ABCD12</span></p>
                
                <div class="lobby">
                    <h3><i class="fas fa-users mr-1"></i> Pemain di Room</h3>
                    <div class="player-list" id="guest-player-list">
                        <!-- Player list will be populated here -->
                    </div>
                </div>
                
                <p class="text-center">Menunggu admin memulai game...</p>
            </div>
        </div>

        <!-- SCREEN 12: GAME BOARD (FOR BOTH OFFLINE AND ONLINE) -->
        <div class="screen" id="game-screen">
            <div class="game-header">
                <h1 class="game-title">Ular Tangga</h1>
                <h2 class="game-subtitle">Truth or Dare Edition</h2>
                <div id="online-status" style="display: none;">
                    <span id="room-code-badge" class="player-status admin"></span>
                    <span id="connection-status" class="player-status ready"></span>
                </div>
            </div>
            
            <div class="scoreboard">
                <h3><i class="fas fa-trophy mr-1"></i> Scoreboard</h3>
                <div id="score-list"></div>
            </div>
            
            <div class="board-container">
                <div class="board" id="game-board"></div>
            </div>
            
            <div class="current-turn" id="current-turn">
                <div class="current-turn-indicator"></div>
                <span id="turn-text">Giliran: Player 1</span>
            </div>
            
            <div class="controls">
                <button id="roll-btn" class="btn btn-secondary">
                    <i class="fas fa-dice mr-1"></i> Lempar Dadu
                </button>
                <div class="dice-container">
                    <div class="dice" id="dice">?</div>
                </div>
            </div>

            <!-- VOICE CONTROL -->
            <div class="voice-control">
                <div class="mic-btn" id="mic-btn">
                    <i class="fas fa-microphone"></i>
                </div>
                <p class="mic-status" id="mic-status">Klik mic atau bilang "MULAI"</p>
            </div>
        </div>

        <!-- MODAL: TRUTH/DARE -->
        <div class="modal" id="truth-dare-modal">
            <div class="modal-content">
                <div class="winner-glow"></div>
                <h2>PILIH:</h2>
                <div class="modal-buttons">
                    <button id="truth-btn" class="btn">
                        <i class="fas fa-comment-dots mr-1"></i> Truth
                    </button>
                    <button id="dare-btn" class="btn btn-secondary">
                        <i class="fas fa-running mr-1"></i> Dare
                    </button>
                </div>
                <div id="task-result"></div>
                <button id="continue-btn" class="btn" style="display: none; margin-top: 1rem;">
                    Lanjutkan <i class="fas fa-arrow-right ml-1"></i>
                </button>
            </div>
        </div>

        <!-- MODAL: WINNER -->
        <div class="modal" id="winner-modal">
            <div class="modal-content">
                <div class="winner-glow"></div>
                <h2><i class="fas fa-trophy mr-1"></i> Selamat!</h2>
                <p id="winner-name" style="font-size: 2rem; font-weight: bold; margin: 1rem 0;"></p>
                <button id="play-again-btn" class="btn btn-secondary">
                    <i class="fas fa-redo mr-1"></i> Main Lagi
                </button>
            </div>
        </div>
    </div>

    <script>
        // === GAME DATA ===
        const colors = [
            '#FF6584', // Merah muda
            '#6C63FF', // Ungu
            '#48BB78', // Hijau
            '#F6AD55', // Oranye
            '#9F7AEA', // Lavender
            '#4299E1', // Biru
            '#ED8936', // Jingga
            '#667EEA'  // Biru ungu
        ];

        // Posisi ular & tangga
        const snakes = {
            57: 34, // Turun dari 57 ke 34
            30: 21, // Turun dari 30 ke 21
            87: 68, // Turun dari 87 ke 68
            15: 5,  // Turun dari 15 ke 5
            60: 40  // Turun dari 60 ke 40
        };

        const ladders = {
            10: 24, // Naik dari 10 ke 24
            75: 90, // Naik dari 75 ke 90
            43: 53, // Naik dari 43 ke 53
            38: 46, // Naik dari 38 ke 46
            5: 17   // Naik dari 5 ke 17
        };

        const warningCells = [12, 22, 35, 48, 63, 77, 85, 95];

        const tasks = {
            truth: [
                "Pernah naksir teman sendiri? Ceritakan!",
                "Apa rahasia yang belum pernah kamu ceritakan ke siapapun?",
                "Pernah nyontek saat ujian? Kapan terakhir kali?",
                "Kalau bisa jadi binatang, mau jadi apa dan kenapa?",
                "Apa hal paling memalukan yang pernah terjadi padamu?",
                "Apa kebiasaan anehmu yang tidak diketahui orang lain?",
                "Pernah berbohong ke orang tua tentang apa?",
                "Apa hal paling bodoh yang pernah kamu lakukan?"
            ],
            dare: [
                "Tirukan suara ayam selama 10 detik!",
                "Minum air tanpa menggunakan tangan",
                "Tari seperti bebek selama 30 detik",
                "Panggil aku 'Yang Mulia' sampai giliranmu berikutnya",
                "Tirukan gaya jalan model di catwalk",
                "Nyanyi lagu anak kecil dengan suara keras",
                "Biarkan orang sebelahmu menggambar di wajahmu",
                "Ucapkan alfabet terbalik dari Z ke A"
            ]
        };

        // Game state
        let players = [];
        let positions = {};
        let currentPlayer = 0;
        let playerCount = 0;
        let recognition;
        let isListening = false;
        let isOnlineGame = false;
        let isHost = false;
        let roomCode = '';
        let socket;
        let myPlayerId = '';
        let maxPlayers = 2;
        let customTasks = {};
        let currentTaskPlayer = 0;
        let tasksPerPlayer = {};
        const maxTasksPerPlayer = 3;

        // === CUSTOM TASKS FUNCTIONS ===
        function showCustomTaskScreen() {
            document.getElementById('current-player-name').textContent = players[currentTaskPlayer].name;
            resetTaskForm();
            updateTaskCounter();
            switchScreen('custom-tasks-screen');
        }

        function resetTaskForm() {
            document.getElementById('task-type').value = 'truth';
            document.getElementById('task-text').value = '';
            document.getElementById('task-cell').value = '';
        }

        function updateTaskCounter() {
            const playerName = players[currentTaskPlayer].name;
            const taskCount = tasksPerPlayer[playerName] || 0;
            document.getElementById('task-counter').textContent = 
                `Anda telah membuat ${taskCount} dari ${maxTasksPerPlayer} tantangan`;
            
            // Disable "Tambah Lagi" button jika sudah mencapai maksimum
            document.getElementById('add-task-btn').disabled = taskCount >= maxTasksPerPlayer;
        }

        function saveCurrentTask() {
            const type = document.getElementById('task-type').value;
            const text = document.getElementById('task-text').value.trim();
            const cell = parseInt(document.getElementById('task-cell').value);
            const playerName = players[currentTaskPlayer].name;

            // Validasi input
            if (!text) {
                alert('Teks tantangan tidak boleh kosong!');
                return false;
            }

            if (isNaN(cell) || cell < 1 || cell > 100) {
                alert('Nomor kotak harus antara 1-100!');
                return false;
            }

            // Simpan task
            if (!customTasks[playerName]) {
                customTasks[playerName] = [];
            }

            customTasks[playerName].push({ type, text, cell });
            
            // Update counter
            tasksPerPlayer[playerName] = (tasksPerPlayer[playerName] || 0) + 1;
            updateTaskCounter();

            return true;
        }

        function moveToNextPlayer() {
            currentTaskPlayer++;
            
            if (currentTaskPlayer < players.length) {
                showCustomTaskScreen();
            } else {
                // Semua pemain sudah mengisi, mulai game
                if (isOnlineGame && isHost) {
                    startOnlineGame();
                } else {
                    initGameBoard();
                    switchScreen('game-screen');
                }
            }
        }

        // === GAME FUNCTIONS ===
        function initGame() {
            // Setup event listeners
            document.getElementById('start-btn').addEventListener('click', () => switchScreen('mode-screen'));

            // Mode selection
            document.getElementById('offline-mode').addEventListener('click', () => {
                isOnlineGame = false;
                switchScreen('rules-screen');
            });

            document.getElementById('online-mode').addEventListener('click', () => {
                isOnlineGame = true;
                switchScreen('online-options-screen');
            });

            // Online game options
            document.getElementById('create-room-btn').addEventListener('click', () => {
                isHost = true;
                switchScreen('create-room-screen');
            });

            document.getElementById('join-room-btn').addEventListener('click', () => {
                isHost = false;
                switchScreen('join-room-screen');
            });

            // Create room
            document.getElementById('create-room-confirm').addEventListener('click', () => {
                const name = document.getElementById('host-name').value;
                maxPlayers = parseInt(document.getElementById('max-players').value);
                
                if (!name) {
                    alert('Mohon masukkan nama Anda');
                    return;
                }
                
                initSocketConnection();
                switchScreen('host-lobby-screen');
                
                // Simulate players joining
                simulatePlayerJoin();
            });

            // Join room
            document.getElementById('join-room-confirm').addEventListener('click', () => {
                const name = document.getElementById('join-player-name').value;
                const code = document.getElementById('room-code').value;
                
                if (!name || !code) {
                    alert('Mohon masukkan nama dan kode room');
                    return;
                }
                
                initSocketConnection();
                switchScreen('guest-lobby-screen');
                
                // Simulate being added to the game
                setTimeout(() => {
                    addPlayerToList(name, myPlayerId);
                }, 1000);
            });

            // Host starts the game
            document.getElementById('host-start-btn').addEventListener('click', () => {
                startCustomTasks();
            });

            // Offline game flow
            document.getElementById('next-btn').addEventListener('click', () => switchScreen('count-screen'));

            // Player count selection
            document.querySelectorAll('.count-btn').forEach(button => {
                button.addEventListener('click', function() {
                    playerCount = parseInt(this.getAttribute('data-count'));
                    setupPlayerInputs();
                    switchScreen('names-screen');
                });
            });

            // Start offline game
            document.getElementById('start-game-btn').addEventListener('click', () => startGame());

            // Custom tasks controls
            document.getElementById('add-task-btn').addEventListener('click', () => {
                if (saveCurrentTask()) {
                    resetTaskForm();
                }
            });

            document.getElementById('done-task-btn').addEventListener('click', () => {
                if ((tasksPerPlayer[players[currentTaskPlayer].name] || 0) === 0) {
                    if (!saveCurrentTask()) {
                        return;
                    }
                }
                moveToNextPlayer();
            });

            // Game controls
            document.getElementById('roll-btn').addEventListener('click', () => rollDice());
            document.getElementById('truth-btn').addEventListener('click', () => showTask('truth'));
            document.getElementById('dare-btn').addEventListener('click', () => showTask('dare'));
            document.getElementById('continue-btn').addEventListener('click', () => continueGame());
            document.getElementById('play-again-btn').addEventListener('click', () => resetGame());

            // Start with first screen
            switchScreen('start-screen');
        }

        function startGame() {
            const inputs = document.querySelectorAll('#player-inputs input');
            let allValid = true;

            inputs.forEach(input => {
                if (input.value.trim() === '') {
                    allValid = false;
                    input.style.borderColor = 'var(--danger)';
                } else {
                    input.style.borderColor = '#e2e8f0';
                }
            });

            if (!allValid) {
                alert('Mohon isi semua nama pemain!');
                return;
            }

            // Initialize players
            players = [];
            positions = {};
            currentPlayer = 0;
            currentTaskPlayer = 0;
            tasksPerPlayer = {};
            customTasks = {};

            inputs.forEach((input, index) => {
                const player = {
                    name: input.value.trim(),
                    color: colors[index],
                    number: index + 1
                };
                players.push(player);
                positions[player.name] = 1;
                tasksPerPlayer[player.name] = 0;
            });

            // Start custom tasks
            startCustomTasks();
        }

        function startCustomTasks() {
            currentTaskPlayer = 0;
            showCustomTaskScreen();
        }

        function initGameBoard() {
            const board = document.getElementById('game-board');
            board.innerHTML = '';

            // Create board from 100 to 1 (snakes and ladders pattern)
            for (let i = 100; i >= 1; i--) {
                const cell = document.createElement('div');
                cell.className = 'cell';
                
                // Add cell number
                const cellNumber = document.createElement('span');
                cellNumber.className = 'cell-number';
                cellNumber.textContent = i;
                cell.appendChild(cellNumber);

                if (snakes[i]) {
                    cell.classList.add('snake');
                    const snakeIcon = document.createElement('i');
                    snakeIcon.className = 'fas fa-snake';
                    cell.appendChild(snakeIcon);
                } else if (ladders[i]) {
                    cell.classList.add('ladder');
                    const ladderIcon = document.createElement('i');
                    ladderIcon.className = 'fas fa-ladder';
                    cell.appendChild(ladderIcon);
                } else if (isWarningCell(i)) {
                    cell.classList.add('warning');
                    const warningIcon = document.createElement('i');
                    warningIcon.className = 'fas fa-exclamation';
                    cell.appendChild(warningIcon);
                }

                board.appendChild(cell);
            }

            updatePieces();
            updateScoreboard();
            updateCurrentTurn();
            initVoiceControl();
        }

        function isWarningCell(cellNumber) {
            // Check if any player has placed a task on this cell
            for (const playerName in customTasks) {
                if (customTasks[playerName].some(task => task.cell === cellNumber)) {
                    return true;
                }
            }
            return warningCells.includes(cellNumber);
        }

        function getTaskForCell(cellNumber) {
            // Check custom tasks first
            for (const playerName in customTasks) {
                const task = customTasks[playerName].find(t => t.cell === cellNumber);
                if (task) return task;
            }
            
            // Default to random task if no custom task
            const type = Math.random() > 0.5 ? 'truth' : 'dare';
            const tasksArray = tasks[type];
            return {
                type,
                text: tasksArray[Math.floor(Math.random() * tasksArray.length)]
            };
        }

        // ... (fungsi lainnya seperti rollDice, movePlayer, dll tetap sama)

        // Start the game when page loads
        document.addEventListener('DOMContentLoaded', initGame);
    </script>
</body>
</html>
